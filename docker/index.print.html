<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.104.3">
    <meta name="generator" content="Relearn 5.6.5+tip">
    <meta name="description" content="">
    <title>Docker :: Chiyo&#39;s blog</title>
    <link href="https://moematsuda-ai.github.io/watanuki/docker/index.html" rel="canonical" type="text/html" title="Docker :: Chiyo&#39;s blog">
    <link href="/watanuki/docker/index.xml" rel="alternate" type="application/rss+xml" title="Docker :: Chiyo&#39;s blog">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/watanuki/css/fontawesome-all.min.css?1669466243" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/watanuki/css/fontawesome-all.min.css?1669466243" rel="stylesheet"></noscript>
    <link href="/watanuki/css/featherlight.min.css?1669466243" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/watanuki/css/featherlight.min.css?1669466243" rel="stylesheet"></noscript>
    <link href="/watanuki/css/auto-complete.css?1669466243" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/watanuki/css/auto-complete.css?1669466243" rel="stylesheet"></noscript>
    <link href="/watanuki/css/perfect-scrollbar.min.css?1669466243" rel="stylesheet">
    <link href="/watanuki/css/nucleus.css?1669466243" rel="stylesheet">
    <link href="/watanuki/css/fonts.css?1669466243" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/watanuki/css/fonts.css?1669466243" rel="stylesheet"></noscript>
    <link href="/watanuki/css/theme.css?1669466243" rel="stylesheet">
    <link href="/watanuki/css/theme-relearn-dark.css?1669466243" rel="stylesheet" id="variant-style">
    <link href="/watanuki/css/ie.css?1669466243" rel="stylesheet">
    <link href="/watanuki/css/variant.css?1669466243" rel="stylesheet">
    <link href="/watanuki/css/print.css?1669466243" rel="stylesheet" media="print">
    <link href="/watanuki/css/format-print.css?1669466243" rel="stylesheet">
    <script src="/watanuki/js/url.js?1669466243"></script>
    <script src="/watanuki/js/variant.js?1669466243"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="/watanuki/index.search.js";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/moematsuda-ai.github.io\/watanuki/';
      window.variants && variants.init( [ 'relearn-dark', 'relearn-light', 'green', 'black', 'blue', 'learn' ] );
    </script>
    <script src="/watanuki/js/jquery.min.js?1669466243" defer></script>
  </head>
  <body class="mobile-support print" data-url="/watanuki/docker/index.html">
    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable" dir="ltr">
        <div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/watanuki/index.html"><span itemprop="name">Moai&#39;s blog</span></a><meta itemprop="position" content="1"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Docker</span><meta itemprop="position" content="2"></li>
            </ol>
          </div>
        </div>
      </nav>
      <main id="body-inner" class="highlightable chapter narrow" tabindex="-1">
        <div class="flex-block-wrapper">
          <div id="head-tags">
          </div>
          <article class="chapter">
<div class="article-subheading">Chapter 2</div>
<h1 id="docker">Docker</h1>


            <footer class="footline">
            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Docker</h1>
          <article class="default">
<h1 id="post-installation-steps-for-linux">Post Installation Steps for linux</h1>

<h2 id="docker-のインストール後の設定">Docker のインストール後の設定</h2>
<h3 id="docker-group-に追加">docker group に追加</h3>
<h3 id="docker-サービスをデフォルトで起動時に開始するように設定">Docker サービスをデフォルトで起動時に開始するように設定</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo systemctl enable docker.service
</span></span><span style="display:flex;"><span>$ sudo systemctl enable containerd.service
</span></span></code></pre></div><p>無効化は以下の通り</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo systemctl disable docker.service
</span></span><span style="display:flex;"><span>$ sudo systemctl disable containerd.service
</span></span></code></pre></div><p><a href="https://docs.docker.com/engine/install/linux-postinstall/#manage-docker-as-a-non-root-user">インストール後の設定はこちら</a></p>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1 id="copy-and-mount-from-docker-container-or-to-docker-container">Copy and Mount from Docker container or to Docker container</h1>

<h1 id="docker-での-copy-と-mount">docker での copy と mount</h1>
<h2 id="コピー">コピー</h2>
<p>ホストとコンテナ間でファイルをコピーするときは次のようにする</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker cp &lt;option&gt; &lt;コピー元path&gt; &lt;コピー先path&gt;
</span></span></code></pre></div><p>コンテナのパスは<code>&lt;container name&gt;:&lt;path&gt;</code>のように書く</p>
<!-- raw HTML omitted -->
<h2 id="マウント">マウント</h2>
<p>※マウントはコンテナをrunするときにオプションとして指定する</p>
<h3 id="バインドマウント">バインドマウント</h3>
<p>既存（ホスト側）のファイルやフォルダをマウントする方法のこと。</p>
<p>普通のファイル同様に編集やバックアップが可能となるため、頻繁にアクセスするファイルなどはこちらに置く。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker run <span style="color:#f92672">(</span>省略<span style="color:#f92672">)</span> -v &lt;マウント元のパス&gt;:&lt;マウントポイント&gt; <span style="color:#f92672">(</span>省略<span style="color:#f92672">)</span>
</span></span></code></pre></div><h3 id="ボリュームマウント">ボリュームマウント</h3>
<p>ボリュームを作成し、マウントする方法のこと。</p>
<p>Dockerホストから変更を加えたくないようなファイルなどはこちらに置く。</p>
<ul>
<li>
<p>ボリュームの作成</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker volume create &lt;volume name&gt;
</span></span></code></pre></div></li>
<li>
<p>ボリュームの削除</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker volume rm &lt;volume name&gt;
</span></span></code></pre></div></li>
<li>
<p>マウント方法</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker run <span style="color:#f92672">(</span>省略<span style="color:#f92672">)</span> -v &lt;ボリューム名&gt;:&lt;マウントポイント&gt; <span style="color:#f92672">(</span>省略<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>※ただしボリュームが存在しないときには新規作成される。</p>
</li>
<li>
<p>docker volume コマンドにおけるサブコマンド</p>
<table>
<thead>
<tr>
<th>サブコマンド</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td>create</td>
<td>ボリュームの作成</td>
</tr>
<tr>
<td>inspect</td>
<td>ボリュームの詳細情報を確認</td>
</tr>
<tr>
<td>ls</td>
<td>ボリューム一覧を確認</td>
</tr>
<tr>
<td>prune</td>
<td>コンテナからマウントされていないボリュームをすべて削除</td>
</tr>
<tr>
<td>rm</td>
<td>ボリュームの削除</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h3 id="ボリュームマウントとバインドマウントを明示的に指定した設定方法">ボリュームマウントとバインドマウントを明示的に指定した設定方法</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ --mount type<span style="color:#f92672">=</span>&lt;bind or volume&gt;,src<span style="color:#f92672">=</span>&lt;マウント元&gt;,dst<span style="color:#f92672">=</span>&lt;マウント先&gt;
</span></span></code></pre></div><p>※この方法ではバインドマウントとボリュームマウントが明示的に指定されているためわかりやすく、
ボリュームが存在しない場合には新規作成されずエラーが出力される。そのため<code>-v</code>オプションより
<code>--mount</code>オプションを使用することが推奨されている。</p>
<ul>
<li>src は source でもOK</li>
<li>dst は destination でもOK</li>
<li>type=tmpfs としてメモリーを特定のマウント先に指定することもできる。</li>
</ul>
<!-- raw HTML omitted -->
<h2 id="appendix">appendix</h2>
<h3 id="ボリュームのバックアップ方法">ボリュームのバックアップ方法</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker run --rm -v &lt;volume name&gt;:/src -v &lt;バックアップ先のフォルダ名&gt;:/dest busybox tar czf /dest/backup.tar.gz -C /src .
</span></span></code></pre></div><ol>
<li>軽量なLinux イメージの busybox を起動</li>
<li>バックアップ対象をコンテナの /src にボリュームマウント</li>
<li>Docker ホストの任意のディレクトリを /dest にバインドマウント</li>
<li>/src 以下の全ファイルが /dest/backup.tar.gz にバックアップされる</li>
<li>コンテナが破棄される</li>
</ol>
<p>※ただしこの方法ではバックアップしたいボリュームのボリューム名がわかっていなければならない。
バックアップ対象をボリューム名ではなくコンテナのディレクトリ名で指定したい場合は<code>--volume-from</code>オプションを使用する！</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker run --rm --volume-from &lt;container name&gt; -v &lt;バックアップ先&gt;:/dest busybox tar czf /dest/bachup.tar.gz -C /var/lib/mysql .
</span></span></code></pre></div><h3 id="バックアップのリストア">バックアップのリストア</h3>
<p>バックアップを取っておいたデータを任意のvolumeに復元する方法</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker run --rm -v &lt;volume名&gt;:/dest -v &lt;バックアップデータの置かれているディレクトリ&gt;:/src busybox tar xzf /src/backup.ta.gz -C /dest
</span></span></code></pre></div><h3 id="データボリュームコンテナ">データボリュームコンテナ</h3>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1 id="how-to-install-docker">How to install Docker</h1>

<h2 id="1-dockerのインストールの仕方">1. Dockerのインストールの仕方</h2>
<ol>
<li>
<p>古いバージョンをアンインストール</p>
<pre tabindex="0"><code>$ sudo apt-get remove docker docker-engine docker.io containerd runc
</code></pre><blockquote>
<p>It’s OK if <code>apt-get</code> reports that none of these packages are installed.</p>
</blockquote>
</li>
</ol>
<h3 id="11-install-methods">1.1 Install methods</h3>
<p>Dockerのリポジトリをセットアップしてそこからインストール方法が推奨されている。</p>
<p>異なる方法もあるが、ここではリポジトリからインストールを行う。</p>
<ol>
<li>
<p>リポジトリの設定</p>
<pre tabindex="0"><code>$ sudo -E apt-get update
$ sudo apt-get install \
    ca-certificates \
    curl \
    gnupg \
    lsb-release
</code></pre></li>
<li>
<p>Dockerの公式GPGキーを追加</p>
<pre tabindex="0"><code>$ sudo mkdir -p /etc/apt/keyrings
$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
</code></pre></li>
<li>
<p>次のコマンドを使用して、リポジトリを設定</p>
<pre tabindex="0"><code>$ echo \
 &#34;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
 $(lsb_release -cs) stable&#34; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
</code></pre></li>
</ol>
<h3 id="12-dockerengineのインストール">1.2 DockerEngineのインストール</h3>
<ol>
<li><code>apt</code>パッケージインデックスを更新し、Docker Engine、containerd、Docker Composeの最新バージョンをインストールするか、次の手順に進んで特定のバージョンをインストールする</li>
</ol>
<pre tabindex="0"><code>$ sudo apt-get update
$ sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin
</code></pre><ol>
<li>Docker Engineの特定のバージョンをインストールするには、リポジトリに使用可能なバージョンをリストしてから、以下を選択してインストールを行う
<ol>
<li>
<p>リポジトリで利用可能なバージョンを一覧表示</p>
<pre tabindex="0"><code>$ apt-cache madison docker-ce
</code></pre></li>
<li>
<p>たとえば、2番目の列のバージョン文字列を(<code>5:20.10.16~3-0~ubuntu-jammy</code>)使用して特定のバージョンをインストールするならば、次のようなコマンドを実行する</p>
<pre tabindex="0"><code>$ sudo apt-get install docker-ce=5:20.10.13~3-0~ubuntu-hirsute docker-ce-cli=5:20.10.13~3-0~ubuntu-hirsute containerd.io docker-compose-plugin
</code></pre></li>
</ol>
</li>
</ol>
<h3 id="13-proxyの設定">1.3 proxyの設定</h3>
<ol>
<li>
<p>Docker Engine の proxy 設定
<code>docker pull</code> などでイメージを落としてくる場合はDocker Engine にプロキシ設定をする必要がある。</p>
<p><code>/lib/systemd/system/docker.service</code>で環境変数を指定。<code>[Service]</code>の欄の下に<code>Environment</code>を追記すればOK！</p>
<pre tabindex="0"><code>[Service]
Environment=HTTP_PROXY=http://{HOST}:{port}
Environment=HTTPS_PROXY=http://{HOST}:{port}
</code></pre></li>
<li>
<p>Docker コンテナ起動時の proxy 設定
<code>~/.docker/config.json</code> を書いておくとコンテナ内に HTTP_PROXY などを自動で設定してくれる</p>
<p>※Docker Compose のときにはつかえない？</p>
<pre tabindex="0"><code>{
&#34;proxies&#34;: {
    &#34;default&#34;: {
    &#34;httpProxy&#34;: &#34;http://{HOST}:{port}&#34;,
    &#34;httpsProxy&#34;: &#34;http://{HOST}:{port}&#34;
    }
}
}
</code></pre></li>
<li>
<p>proxy設定の反映とDockerを再起動</p>
<pre tabindex="0"><code>$ sudo systemctl daemon-reload
$ sudo systemctl restart docker
</code></pre></li>
</ol>
<h4 id="やってみたけどあまり意味のなかった設定">やってみたけどあまり意味のなかった設定</h4>
<!-- raw HTML omitted -->
<ul>
<li>
<p>upstartの人</p>
<pre tabindex="0"><code>$ sudo cat /etc/default/docker
（省略)
export no_proxy=&#39;export no_proxy=127.0.0.1,localhost,xxx.xxx.xxx.xxx&#39;
export NO_PROXY=&#34;${no_proxy}&#34;
export http_proxy=&#39;http://your.proxy.url:port/&#39;
export HTTP_PROXY=&#34;${http_proxy}&#34;
export https_proxy=&#39;https://your.proxy.url:port/&#39;
export HTTPS_PROXY=&#34;${https_proxy}&#34;
</code></pre></li>
<li>
<p>Systemdの人</p>
<pre tabindex="0"><code>$ sudo cat /etc/systemd/docker.service
（省略）
[Service]
Environment=&#34;HTTP_PROXY=http://your.proxy.url:port/&#34; &#34;HTTPS_PROXY=https://your.proxy.url:port/&#34;
</code></pre><p>※　/lib/systemd/system/docker.serviceと併用しようとするとDockerが起動しなくなるので注意！2つの設定が競合するのかな？</p>
</li>
<li>
<p><code>docker.service.d</code>にファイルの追加</p>
<pre tabindex="0"><code>$ cd /etc/systemd/system/
$ mkdir docker.service.d
$ sudo nano http-proxy.conf
    -&gt; 内容の書き込み
</code></pre><pre tabindex="0"><code>$ cat /etc/systemd/system/docker.service.d/http-proxy.conf
[Service]
Environment=&#34;HTTP_PROXY=http://proxy.example.com:8080/&#34;
Environment=&#34;HTTPS_PROXY=http://proxy.example.com:8080/&#34;
</code></pre></li>
</ul>
<!-- raw HTML omitted -->
<h3 id="14-確認">1.4 確認</h3>
<ol>
<li><code>hello-world</code>イメージを走らせ、Dockerが正しくインストールされていることを確認
<pre tabindex="0"><code>$ sudo docker run hello-world
</code></pre></li>
</ol>
<h2 id="2-dockerのアンインストール方法">2. Dockerのアンインストール方法</h2>
<ol>
<li>
<p>Docker Engine、CLI、Containerd、およびDockerComposeパッケージをアンインストール</p>
<pre tabindex="0"><code>$ sudo apt-get purge docker-ce docker-ce-cli containerd.io docker-compose-plugin
</code></pre></li>
<li>
<p>ホスト上のイメージ、コンテナー、ボリューム、またはカスタマイズされた構成ファイルは自動的に削除ない。すべてのイメージ、コンテナー、およびボリュームを削除するには下記を実行</p>
<pre tabindex="0"><code>$ sudo rm -rf /var/lib/docker
$ sudo rm -rf /var/lib/containerd
</code></pre></li>
</ol>
<p>※編集した構成ファイルは手動で削除する必要がある</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h2 id="3-問題とその解決策">3. 問題とその解決策</h2>
<h3 id="31--sudo-docker-run-hello-worldを実行するとタイムアウトしてしまう">3.1 <code>$ sudo docker run hello-world</code>を実行するとタイムアウトしてしまう</h3>
<h4 id="インターネットに接続できない">インターネットに接続できない</h4>
<p>-&gt; proxyを設定（上記参照）</p>
<h4 id="proxy-設定してもdockerイメージが取得できないconectできない">proxy 設定してもDockerイメージが取得できない(conectできない)…</h4>
<p>おそらく公開鍵の問題！</p>
<p><code>apt update</code>などを実行すると、「公開鍵を利用できないため、以下の署名は検証できませんでした」というエラーが出る。</p>
<p>つまり<!-- raw HTML omitted --><strong>GPGエラー</strong><!-- raw HTML omitted -->が問題だった！</p>
<p>ということでOpenGPG鍵をインポート</p>
<pre tabindex="0"><code>$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-k
</code></pre><p>DockerのインストールでもGPG鍵キーのインストールはしているが、おそらく以下のどちらかが問題だった…</p>
<ul>
<li><code>Install method</code>の 2. でもインストールしてるけど<code>etc</code>のところを<code>usr</code>にしなければならなかった</li>
<li><code>1.2 DockerEngineのインストール</code>はどちらも実行してしまい、DockerイメージをダウングレードしてしまったためGPGエラーが起こった（？）</li>
</ul>
<h4 id="補足やってみたけど意味のなかったこと">補足（やってみたけど意味のなかったこと）</h4>
<p>GPGエラーについて</p>
<blockquote>
<p>W: 署名照合中にエラーが発生しました。
リポジトリは更新されず、過去のインデックスファイルが使われます。
GPG エラー: <a href="http://packages.cloud.google.com/apt">http://packages.cloud.google.com/apt</a> cloud-sdk-xenial InRelease: 公開鍵を利用できないため、
以下の署名は検証できませんでした: NO_PUBKEY 6A030B21BA07F4FB</p>
</blockquote>
<p>と出力されたため、<code>apt-key</code>コマンドでパブリックキーを追加した（パブリックキーの有効期限切れだと思った…）</p>
<pre tabindex="0"><code>$ sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 6A030B21BA07F4FB
</code></pre><p>-&gt; <code>apt-key</code>ではproxyにうまく接続できない問題が発生…</p>
<p>-&gt; <code>--keyserver-option</code>を使用してproxyサーバを指定</p>
<pre tabindex="0"><code>$ sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --keyserver-option http-proxy=http://x:y@proxy:port --recv-keys 36A1D7869245C8950F966E92D8576A8BA88D21E9
Executing: gpg --ignore-time-conflict --no-options --no-default-keyring --secret-keyring /tmp/tmp.oqJcUg9wwq --trustdb-name /etc/apt/trustdb.gpg --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg --keyserver hkp://keyserver.ubuntu.com:80 --keyserver-option http-proxy=http://x:y@proxy:port --recv-keys 36A1D7869245C8950F966E92D8576A8BA88D21E9
gpg: 鍵A88D21E9をhkpからサーバーkeyserver.ubuntu.comに要求
gpg: 鍵A88D21E9: 公開鍵“Docker Release Tool (releasedocker) &lt;docker@dotcloud.com&gt;”を読み込みました
gpg: 処理数の合計: 1
gpg:               読込み: 1  (RSA: 1)
</code></pre><h3 id="32-インターネットにブラウザで接続できない">3.2 インターネットに（ブラウザで）接続できない</h3>
<p>proxyの設定とGPG鍵のインストールで<code>$ sudo docker run hello-world</code>は実行できるようになったが、未だChromeやFireFoxが使えない（インターネットに接続できない）…</p>
<ol>
<li>
<p>docker ではUbuntuの以下4つのバージョンでしか正常に動作することが保証されてなかったため、Ubuntu21.04ではうまく行かなかった</p>
<ul>
<li>Ubuntu Jammy 22.04 (LTS)</li>
<li>Ubuntu Impish 21.10</li>
<li>Ubuntu Focal 20.04 (LTS)</li>
<li>Ubuntu Bionic 18.04 (LTS)</li>
</ul>
</li>
<li>
<p>22.04 に upgrade したら使えるように！　→ Ubuntu22.04 のproxy設定を手動にしたら使えるようになった！</p>
</li>
</ol>
<h2 id="参考">参考</h2>
<h3 id="dockerのインストール">Dockerのインストール</h3>
<ul>
<li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/engine/install/ubuntu/">Docker Engine インストール（Ubuntu 向け）</a></li>
<li><a href="https://docs.docker.com/engine/install/ubuntu/">Install Docker Engine on Ubuntu</a></li>
<li><a href="https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html#docker">Installation Guide(NVIDIA)</a></li>
</ul>
<h3 id="proxy設定">proxy設定</h3>
<ul>
<li><a href="https://qiita.com/hoto17296/items/d8860d49b2f3d7c17613#docker-%E3%82%A4%E3%83%A1%E3%83%BC%E3%82%B8%E3%81%AE%E3%83%93%E3%83%AB%E3%83%89%E6%99%82">プロキシ環境下の Docker</a></li>
<li><a href="https://qiita.com/Riliumph/items/921e76444ea6ba145294">Proxy環境でdockerを外に繋ぐ方法</a></li>
<li><a href="https://docs.docker.jp/network/proxy.html">プロキシサーバを使うように Docker を設定</a></li>
<li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/network/proxy/">プロキシーサーバー利用の設定</a></li>
<li><a href="https://www.softek.co.jp/SID/support/sidfmvm/guide/install-docker-ubuntu1804.html">Ubuntu 18.04 LTS / 20.04 LTS に Docker をインストールする</a></li>
</ul>
<h3 id="問題">問題</h3>
<h4 id="gpgエラーについて">GPGエラーについて</h4>
<ul>
<li><a href="https://zenn.dev/spiegel/articles/20220508-apt-key-is-deprecated">GPGエラーの解決策（「apt-key が非推奨になったので」</a></li>
<li><a href="https://hibiki-press.tech/dev-env/apt-update-gpg/1976">【Ubuntu】 apt update時のGPGエラー対処</a></li>
<li><a href="https://qiita.com/nmatsui/items/816051fe6445db116e9a">ubuntuで認証プロキシ配下からapt-keyを使うとき</a></li>
</ul>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1 id="docker-container-for-cuda">Docker Container for Cuda</h1>

<h2 id="docker-の-cuda-コンテナの追加設定">docker の cuda コンテナの追加設定</h2>
<h3 id="1-bashrc-の変更">1. .bashrc の変更</h3>
<ul>
<li><code>/home/</code> と <code>/root/</code> 以下に保存
<ul>
<li><code>/home/</code> はボリュームマウントしているので、新しくコンテナを作成する場合は設定ファイルを <code>/home/</code> の保存し、作成したコンテナで <code>/home/</code> 以下の設定ファイルをコピーすること！</li>
</ul>
</li>
</ul>
<h3 id="2-python-のライブラリの追加">2. python のライブラリの追加</h3>
<p>ライブラリを追加するディレクトリにパスを通す</p>
<pre tabindex="0"><code>$ export PYTHONPATH=&#34;/root/.local/lib/python3.8/site-pachages/:$PYTHONPATH&#34;
</code></pre><ul>
<li>moysnn ライブラリのシンボリックリンクを&quot;/root/.local/lib/python3.8/site-pachages/&ldquo;以下に作成</li>
</ul>
<h3 id="3-コマンドのインストール">3. コマンドのインストール</h3>
<ul>
<li>tree</li>
<li>trash</li>
</ul>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1 id="connect-to-docker-container-via-ssh">Connect to Docker Container via ssh</h1>

<p>dockerでsshを行う場合にはopensshd-serverをインストールし、設定を行う必要がある。</p>
<blockquote>
<p>settings.sh</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>export DEBIAN_FRONTEND<span style="color:#f92672">=</span>noninteractive
</span></span><span style="display:flex;"><span>apt-get install -y openssh-server 
</span></span><span style="display:flex;"><span>export mkdir /var/run/sshd
</span></span><span style="display:flex;"><span>export ENV<span style="color:#f92672">=</span>NOTVISIBLE <span style="color:#e6db74">&#34;in users profile&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;export VISIBLE=now&#34;</span> &gt;&gt; /etc/profile
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;service ssh start&#34;</span> &gt;&gt; /etc/profile
</span></span></code></pre></div><blockquote>
<p>Dockerfile</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Dockerfile" data-lang="Dockerfile"><span style="display:flex;"><span><span style="color:#66d9ef">RUN</span> bash /tmp/setting.sh<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">EXPOSE</span><span style="color:#e6db74"> &lt;port&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">CMD</span> [<span style="color:#e6db74">&#34;/usr/sbin/sshd&#34;</span>, <span style="color:#e6db74">&#34;-D&#34;</span>]<span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>ただしssh-serverが起動していなければ接続できない。そのため、コンテナ内で以下のコマンドを使用し、サーバーが止まっていないかを確認すること。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ service ssh status
</span></span></code></pre></div><h4 id="start-or-stop-ssh">start or stop ssh</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ service ssh start
</span></span></code></pre></div><pre tabindex="0"><code>$ service ssh stop
</code></pre><h1 id="trouble">trouble</h1>
<h4 id="何度もuser名などを変えているとssh接続できない">何度もuser名などを変えているとssh接続できない…</h4>
<p>known_hostsファイルの情報と異なるためsshできなくなる</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ssh-keygen -f <span style="color:#e6db74">&#34;&lt;path of known-hosts file&gt;&#34;</span> -R <span style="color:#e6db74">&#34;[&lt;host&gt;]:&lt;port&gt;&#34;</span>
</span></span></code></pre></div><p>と実行すればOK! (log標準出力でも表示されるのでそちらを参照！）</p>
<ul>
<li>詳しくは<a href="https://qiita.com/hnw/items/0eeee62ce403b8d6a23c">こちら</a></li>
</ul>
<h2 id="参照">参照</h2>
<ul>
<li><a href="https://qiita.com/YumaInaura/items/1d5c18a9e55484ccad89">docker 「コンテナを ssh 接続できるようにするDockerfile」チュートリアル解説</a></li>
<li><a href="https://qiita.com/yagince/items/deba267f789604643bab">Docker Ubuntu18.04でtzdataをinstallするときにtimezoneの選択をしないでinstallする</a></li>
<li><a href="https://qiita.com/dev-tatsuya/items/997c438019850e275a3e">はじめてのLinux(CentOS)サーバ構築 〜SSH接続、IP制限〜</a></li>
<li><a href="https://qiita.com/hnw/items/0eeee62ce403b8d6a23c">「SSHホスト鍵が変わってるよ！」と怒られたときの対処</a></li>
</ul>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1 id="how-to-install-docker-compose">How to install Docker Compose</h1>

<ol>
<li>update</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt update
</span></span><span style="display:flex;"><span>$ sudo apt upgrade
</span></span></code></pre></div><ol>
<li>file のダウンロード</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo curl -L <span style="color:#e6db74">&#34;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-</span><span style="color:#66d9ef">$(</span>uname -s<span style="color:#66d9ef">)</span><span style="color:#e6db74">-</span><span style="color:#66d9ef">$(</span>uname -m<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> -o /usr/local/bin/docker-compose
</span></span></code></pre></div><ol>
<li>権限の付与</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo chmod +x /usr/local/bin/docker-compose
</span></span></code></pre></div><ol>
<li>動作確認</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker-compose --version
</span></span></code></pre></div><h2 id="docker-compose-のアップグレード">docker compose のアップグレード</h2>
<p>docker compose の v1 系をインストールしてしまっていたので v2 系にグレードアップ</p>
<h3 id="1系のdocker-compose-の削除">1系のDocker compose の削除</h3>
<p><code>/usr/local/bin/</code>にある<code>docker-compose</code>ディレクトリを削除</p>
<pre tabindex="0"><code>$ sudo trash docker-compose 
</code></pre><h3 id="新しいdocker-compose-のインストール">新しいDocker compose のインストール</h3>
<ol>
<li>
<p>以下のコマンドを実行して Docker Compose の現時点での最新安定版をダウンロードします。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ DOCKER_CONFIG<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>DOCKER_CONFIG<span style="color:#66d9ef">:-</span>$HOME/.docker<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>$ mkdir -p $DOCKER_CONFIG/cli-plugins
</span></span><span style="display:flex;"><span>$ curl -SL https://github.com/docker/compose/releases/download/v2.4.1/docker-compose-linux-x86_64 -o $DOCKER_CONFIG/cli-plugins/docker-compose
</span></span></code></pre></div><p>このコマンドによって、アクティブユーザーの$HOMEディレクトリ配下に Compose がインストールされます。 システム上の全ユーザー向けに Docker Compose をインストールする場合は、~/.docker/cli-pluginsの部分を/usr/local/lib/docker/cli-pluginsに置き換えます。</p>
<p>別のバージョンをインストールする場合は<code>v2.4.1</code> の部分を書き換える</p>
</li>
<li>
<p>実行バイナリに対して実行権限を与えます。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ chmod +x $DOCKER_CONFIG/cli-plugins/docker-compose
</span></span></code></pre></div></li>
<li>
<p>インストール結果をテストします。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker compose version
</span></span></code></pre></div></li>
</ol>
<h3 id="アンインストールする場合">アンインストールする場合</h3>
<ul>
<li>curlを使って Docker Compose をインストールしていた場合は、次のようにしてアンインストールします。
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rm $DOCKER_CONFIG/cli-plugins/docker-compose
</span></span></code></pre></div></li>
</ul>
<h2 id="参考">参考</h2>
<ul>
<li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/compose/install/">docker docs</a></li>
</ul>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1 id="docker-compose">Docker Compose</h1>

<h2 id="dockerでcudaコンテナの作成">dockerでcudaコンテナの作成</h2>
<h3 id="cuda-のgpg-key-登録">cuda の　GPG key 登録</h3>
<ol>
<li>
<p>古いキーの削除</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt-key del 7fa2af80
</span></span></code></pre></div></li>
<li>
<p>ヘルパーパッケージを利用したキーの登録
nvidia が提供している、nvidia リポジトリ用の新しい署名キーのインストールを自動化する新しいヘルパーパッケージを利用して鍵を登録</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2204/x86_64/cuda-keyring_1.0-1_all.deb
</span></span><span style="display:flex;"><span>$ sudo dpkg -i cuda-keyring_1.0-1_all.deb
</span></span></code></pre></div><p>※<code>ubuntu2204</code>と<code>x86_64</code>は該当のものに書き換える</p>
</li>
<li>
<p>remove の仕方
※インストール時にターミナルに表示された文</p>
<pre tabindex="0"><code>A deprecated public CUDA GPG key appear to be installed.
To remove the key, run this command:
sudo apt-key del 7fa2af80
</code></pre></li>
</ol>
<h3 id="結局必要だったのかわからなかったけどとりあえずやったこと">結局必要だったのかわからなかったけどとりあえずやったこと</h3>
<h4 id="setting-up-nvidia-container-toolkit">Setting up NVIDIA Container Toolkit</h4>
<ol>
<li>
<p>パッケージリポジトリと GPG key のセットアップ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ distribution<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>. /etc/os-release;echo $ID$VERSION_ID<span style="color:#66d9ef">)</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    <span style="color:#f92672">&amp;&amp;</span> curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    <span style="color:#f92672">&amp;&amp;</span> curl -s -L https://nvidia.github.io/libnvidia-container/$distribution/libnvidia-container.list | <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            sed <span style="color:#e6db74">&#39;s#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g&#39;</span> | <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list
</span></span></code></pre></div></li>
<li>
<p><code>nvidia-docker2</code> パッケージのインストール</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt-get update
</span></span><span style="display:flex;"><span>$ sudo apt-get install -y nvidia-docker2
</span></span></code></pre></div></li>
<li>
<p>Docker demon のリスタート</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo systemctl restart docker
</span></span></code></pre></div></li>
<li>
<p>ベースとなるCUDAコンテナを実行することによって、動作するセットアップをテスト</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo docker run --rm --gpus all nvidia/cuda:11.0.3-base-ubuntu20.04 nvidia-smi
</span></span></code></pre></div><p>以下のような出力ならOK！</p>
<pre tabindex="0"><code>+-----------------------------------------------------------------------------+
| NVIDIA-SMI 450.51.06    Driver Version: 450.51.06    CUDA Version: 11.0     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            On   | 00000000:00:1E.0 Off |                    0 |
| N/A   34C    P8     9W /  70W |      0MiB / 15109MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
</code></pre></li>
</ol>
<h4 id="containerd">containerd</h4>
<ol>
<li>
<p>コンテナエンジンとしてcontainerdをシステムにインストールするために、いくつかの前提モジュールをインストール</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo modprobe overlay <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    <span style="color:#f92672">&amp;&amp;</span> sudo modprobe br_netfilter
</span></span></code></pre></div></li>
<li>
<p>これらを確実に持続させることができる</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat <span style="color:#e6db74">&lt;&lt;EOF | sudo tee /etc/modules-load.d/containerd.conf
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">overlay
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">br_netfilter
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span></code></pre></div></li>
<li>
<p>apt が HTTPS 上でリポジトリを使用できるようにするためのパッケージをインストール</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt update
</span></span><span style="display:flex;"><span>$ sudo apt-get install <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    ca-certificates <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    curl <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    gnupg <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    lsb-release
</span></span></code></pre></div></li>
<li>
<p>リポジトリとGPG key の追加</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/  docker-archive-keyring.gpg
</span></span><span style="display:flex;"><span>$ echo <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    <span style="color:#e6db74">&#34;deb [arch=</span><span style="color:#66d9ef">$(</span>dpkg --print-architecture<span style="color:#66d9ef">)</span><span style="color:#e6db74"> signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    </span><span style="color:#66d9ef">$(</span>lsb_release -cs<span style="color:#66d9ef">)</span><span style="color:#e6db74"> stable&#34;</span> | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
</span></span></code></pre></div><p>※1回やってたらいらないかも…</p>
</li>
</ol>
<h2 id="dockerfile-and-docker-composeyml-の作成">Dockerfile and docker-compose.yml の作成</h2>
<h3 id="docker-compose-と-dockerfileを使う場合">docker compose と Dockerfileを使う場合</h3>
<ul>
<li><a href="https://github.com/MoeMatsuda-ai/docker-set">こちらを参照</a></li>
</ul>
<h4 id="コンテナ作成後の設定">コンテナ作成後の設定</h4>
<ol>
<li>鍵の作成</li>
<li>ssh server の起動
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ bash ./sterter.sh
</span></span></code></pre></div></li>
<li>vscodeのsettings.jsonとkeyboard.jsonの設定</li>
<li>rootのパスワード設定</li>
</ol>
<h3 id="dockerfile-のみの場合">Dockerfile のみの場合</h3>
<ul>
<li><a href="/watanuki/docker/docker-compose-cuda/index.html/docker-compose-cuda-Dockerfile">こちらを参照</a></li>
</ul>
<h2 id="trouble">trouble</h2>
<h4 id="apt-が使えない">apt が使えない…</h4>
<p>コンテナにはproxyを通してたけどaptに通すのを忘れてた…</p>
<p>Dockerfile の <code>apt update</code> の前に以下の文を追加</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>RUN echo <span style="color:#e6db74">&#39;Acquire::http::proxy &#34;http://proxy.cc.yamaguchi-u.ac.jp:8080&#34;; \
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Acquire::https::proxy &#34;https://proxy.cc.yamaguchi-u.ac.jp:8080&#34;;&#39;</span> &gt; /etc/apt/apt.conf
</span></span></code></pre></div><h4 id="nvidia-gpg-key-の更新">nvidia gpg key の更新</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt-key del 7fa2af80
</span></span><span style="display:flex;"><span>$ wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64/cuda-keyring_1.0-1_all.deb
</span></span><span style="display:flex;"><span>$ sudo dpkg -i cuda-keyring_1.0-1_all.deb 
</span></span><span style="display:flex;"><span>$ sudo apt update
</span></span></code></pre></div><h4 id="cuda-version-を下げるとapt-update-が通らなくなる">cuda version を下げると<code>apt update</code> が通らなくなる</h4>
<pre tabindex="0"><code>RUN apt-get update &amp;&amp; apt-get install -y \
  bzr \
  cvs \
  git \
  mercurial \
  subversion
</code></pre><p>みたいな感じで <code>update</code> と <code>install</code> をつなげてみたけどだめだった…</p>
<h4 id="nvidiaのドライバが使えなくなった">nvidiaのドライバが使えなくなった…</h4>
<ol>
<li>nvidia driverのバージョンを落としてインストールし直す</li>
<li>nvidia container toolkitをインストール</li>
<li>proxy設定</li>
</ol>
<h1 id="参照">参照</h1>
<ul>
<li><a href="https://hub.docker.com/r/nvidia/cuda">Dockerhub nvidia/cuda</a></li>
<li><a href="https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html#setting-up-nvidia-container-toolkit">NVIDA Installation Guide</a></li>
<li><a href="https://qiita.com/kaijism/items/ada49192df0a6d285c3a">【Docker】GPU が使える Jupyter Notebook 環境を最速で用意する</a></li>
<li><a href="https://qiita.com/ksasaki/items/b20a785e1a0f610efa08">NVIDIA Docker って今どうなってるの？ (19.11版)</a></li>
<li><a href="http://bcl.sci.yamaguchi-u.ac.jp/~jun/notebook/docker/">西井先生のページ</a></li>
<li><a href="https://qiita.com/tkusumi/items/f275f0737fb5b261a868">NVIDIA Container Toolkit (NVIDIA Docker) は何をしてくれるか</a></li>
<li><a href="https://qiita.com/tifa2chan/items/1aa93bde3aa26dcf2060">Dockerfileのプロキシ設定</a></li>
<li><a href="https://docs.docker.jp/v1.11/engine/userguide/containers/dockerizing.html">コンテナで Hello world</a></li>
<li><a href="https://ricrowl.hatenablog.com/entry/2020/05/21/222821">docker上でjupyter-notebookを使用する方法</a></li>
<li><a href="https://tech-blog.optim.co.jp/entry/2022/05/18/100000">NVIDIA DockerイメージのGPGキー更新に関する備忘録</a></li>
<li><a href="https://www.nemotos.net/?p=5178">NVIDIAのリポジトリのキーが更新されました。（2022年4月28日）</a></li>
<li><a href="https://docs.docker.jp/engine/articles/dockerfile_best-practice.html">Dockerfile のベストプラクティス</a></li>
<li><a href="https://qiita.com/satodoc/items/188a387f7439e4ec394f">docker-composeで作成されるものの名前を明示的に指定する方法</a></li>
</ul>
<h2 id="cudaをdockerで使用する際のdockerfileの作成">CudaをDockerで使用する際のDockerfileの作成</h2>
<ol>
<li>
<p>次のようなDockerfileを作成する</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Dockerfile" data-lang="Dockerfile"><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span><span style="color:#e6db74"> nvidia/cuda:11.4.0-cudnn8-devel-ubuntu20.04</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">USER</span><span style="color:#e6db74"> root</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> ./requirements.txt /tmp<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">WORKDIR</span><span style="color:#e6db74"> /code</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># ENV DEBIAN_FRONTEND noninteractive</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> https_proxy <span style="color:#e6db74">&#34;http://&lt;proxy server&gt;&#34;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> https_proxy <span style="color:#e6db74">&#34;http://&lt;proxy server&gt;&#34;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> echo <span style="color:#e6db74">&#39;Acquire::http::proxy &#34;http://&lt;proxy server&gt;&#34;; \
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Acquire::https::proxy &#34;https://&lt;proxy server&gt;&#34;;&#39;</span> &gt; /etc/apt/apt.conf<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> apt-get update <span style="color:#f92672">&amp;&amp;</span> apt-get install -y <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>curl <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>python3 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>python3-distutils<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py <span style="color:#f92672">&amp;&amp;</span> python3 get-pip.py<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> pip install -r /tmp/requirements.txt<span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><ul>
<li>proxy 設定は以下のようにする
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#66d9ef">ENV</span> https_proxy <span style="color:#e6db74">&#34;http://~~~&#34;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> http_proxy <span style="color:#e6db74">&#34;http://~~~&#34;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div></li>
<li>**cuda の　version を下げると <code>apt update</code> が通らなくなったので、<code>RUN apt-get update</code> 以下はコメントアウトして、
pythonなどはコンテナ作成後にアタッチしてインストールした&hellip;</li>
</ul>
</li>
<li>
<p>同じ階層に <code>requirememts.txt</code> を作成し、 Dockerfile で呼び出せるようにする。
このファイルには必要なパッケージを記入しておく</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>jupyter
</span></span><span style="display:flex;"><span>jupyterlab
</span></span><span style="display:flex;"><span>numpy
</span></span><span style="display:flex;"><span>pandas
</span></span><span style="display:flex;"><span>matplotlib
</span></span><span style="display:flex;"><span>scikit-learn
</span></span><span style="display:flex;"><span>scikit-image
</span></span><span style="display:flex;"><span>scipy
</span></span><span style="display:flex;"><span>torch
</span></span><span style="display:flex;"><span>torchvision
</span></span><span style="display:flex;"><span>tqdm
</span></span><span style="display:flex;"><span>albumentations
</span></span><span style="display:flex;"><span>tensorflow-gpu
</span></span><span style="display:flex;"><span>Pillow
</span></span><span style="display:flex;"><span>opencv-python
</span></span></code></pre></div></li>
<li>
<p>作成したディレクトリ構造は次のようになる</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ tree my-nvidia-cuda/
</span></span><span style="display:flex;"><span>my-nvidia-cuda/
</span></span><span style="display:flex;"><span>├── Dockerfile
</span></span><span style="display:flex;"><span>├── requirements.txt
</span></span><span style="display:flex;"><span>└── src
</span></span><span style="display:flex;"><span>    └── test.ipynb
</span></span></code></pre></div></li>
<li>
<p>Docker イメージをビルド</p>
<pre tabindex="0"><code>$ cd my-nvidia-cuda
$ docker build . -t &lt;image name&gt;
</code></pre></li>
<li>
<p>Docker コンテナを起動</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo docker run -it --gpus<span style="color:#f92672">=</span>all -v <span style="color:#e6db74">&#34;</span>$PWD<span style="color:#e6db74">&#34;</span>:/code -p 8888:8888 --name &lt;container name&gt; &lt;image name&gt; /bin/bash
</span></span></code></pre></div><ul>
<li><code>--gpus</code>はgpuのを列挙</li>
</ul>
</li>
</ol>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1 id="basic-docker-usage">Basic docker usage</h1>

<h2 id="systemctl-の使い方">systemctl の使い方</h2>
<h3 id="docker-の起動と停止">Docker の起動と停止</h3>
<pre tabindex="0"><code>$ systemctl start docker.service
$ systemctl stop docker.service
$ systemctl stop docker.socket
</code></pre><h3 id="設定の反映と再起動">設定の反映と再起動</h3>
<pre tabindex="0"><code>$ systemctl deamon-reload
$ systemctl restart docker.service
</code></pre><h2 id="docker-コマンド">docker コマンド</h2>
<pre tabindex="0"><code>$ docker &lt;上位コマンド&gt; &lt;副コマンド&gt; &lt;オプション&gt; &lt;対象&gt; &lt;引数&gt;
</code></pre><h3 id="option">option</h3>
<table>
<thead>
<tr>
<th>オプションの書式</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ndash;name &lt;コンテナ名&gt;</td>
<td>コンテナ名の指定</td>
</tr>
<tr>
<td>-p &lt;ホストのポート番号&gt;:&lt;コンテナのポート番号&gt;</td>
<td>ポート番号の指定</td>
</tr>
<tr>
<td>-v &lt;ホストのディスク&gt;:&lt;コンテナのディレクトリ&gt;</td>
<td>ボリュームのマウント</td>
</tr>
<tr>
<td>&ndash;net=&lt;ネットワーク&gt;</td>
<td>コンテナをネットワークに接続</td>
</tr>
<tr>
<td>-e &lt;環境変数名&gt;=&lt;値&gt;</td>
<td>環境変数の指定</td>
</tr>
<tr>
<td>-d</td>
<td>バックグラウンドで実行(detach: デタッチモードの略)</td>
</tr>
<tr>
<td>-i</td>
<td>コンテナに操作端末（キーボード）をつなぐ</td>
</tr>
<tr>
<td>-t</td>
<td>特殊キーを使用可能にする</td>
</tr>
<tr>
<td>-help</td>
<td>ヘルプの表示</td>
</tr>
<tr>
<td>&ndash;rm</td>
<td>コンテナ終了時に自動的にコンテナを削除する</td>
</tr>
<tr>
<td>&ndash;workdir <!-- raw HTML omitted -->, -w <!-- raw HTML omitted --></td>
<td>コンテナ内部の作業ディレクトリを変更する</td>
</tr>
</tbody>
</table>
<h3 id="docker-container-の作成">Docker container の作成</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker run &lt;option&gt; &lt;container image&gt; &lt;引数&gt;
</span></span></code></pre></div><p><code>docker run</code>コマンドは、イメージをダウンロードする<code>docker pull</code>, コンテナを作成する<code>docker create</code>, コンテナを起動する<code>docker start</code>コマンドを一つにまとめたもの。</p>
<p>コンテナを起動せずに作成したい(docker createしたい)場合などに, <code>docker create</code>と<code>docker start</code>を分けて使用する。</p>
<h3 id="docker-起動と停止">Docker 起動と停止</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker start &lt;container name or container ID&gt; <span style="color:#75715e">#container の起動(container ID は他と重複しない先頭数文字だけでOK！)</span>
</span></span><span style="display:flex;"><span>$ docker stop &lt;container name or container ID&gt; <span style="color:#75715e">#container のストップ</span>
</span></span></code></pre></div><h3 id="便利なコマンド">便利なコマンド</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker logs &lt;container name&gt; <span style="color:#75715e">#logの確認</span>
</span></span></code></pre></div><h3 id="container-の破棄">container の破棄</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker container ls <span style="color:#75715e">#起動中のコンテナの表示(`docker ps`のように省略可)</span>
</span></span><span style="display:flex;"><span>$ docker container rm &lt;container name&gt; <span style="color:#75715e">#コンテナの削除(``docker rm`のように省略可)</span>
</span></span></code></pre></div><p>起動していないコンテナをすべて削除する場合は</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker container prune
</span></span></code></pre></div><h3 id="image-の破棄">image の破棄</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker image ls <span style="color:#75715e">#ダウンロードしたイメージ一覧</span>
</span></span><span style="display:flex;"><span>$ docker image rm &lt;repository&gt;:&lt;tag&gt; <span style="color:#75715e">#imageの削除(※tag が latest という最新版を表す値の場合は省略可, `docker rmi` のように省略可)</span>
</span></span></code></pre></div><h3 id="docker-の容量利用状況の確認">Docker の容量利用状況の確認</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker system df
</span></span></code></pre></div><h3 id="build-cache-の削除">Build Cache の削除</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker builder prune
</span></span></code></pre></div><p>※キャッシュが貯まると容量を大量に食うので注意！</p>
<h3 id="detachとattach">detachとattach</h3>
<ul>
<li>
<p>detach
Ctrl+P, Ctrl+Q</p>
</li>
<li>
<p>attach</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker attach &lt;container name or containerID&gt;
</span></span></code></pre></div></li>
</ul>
<h3 id="shellの実行">shellの実行</h3>
<table>
<thead>
<tr>
<th>コマンド</th>
<th>コンテナの状態</th>
<th>シェル終了時</th>
</tr>
</thead>
<tbody>
<tr>
<td>docker run</td>
<td>停止時</td>
<td>コンテナ終了</td>
</tr>
<tr>
<td>docker exec</td>
<td>稼働時</td>
<td>稼働のまま</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p><strong>実行中のコンテナの場合</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker exec -it &lt;container name&gt; /bin/bash
</span></span></code></pre></div><p>を実行することでシェルが起動する</p>
<p>※ここで<code>exit</code>しても<code>docker exec</code> で実行したものが終了するだけのため、コンテナは終了しない</p>
</li>
<li>
<p><strong>停止中のコンテナの場合</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker run --name &lt;container name&gt; -it &lt;conteinaer image&gt; /bin/bash
</span></span></code></pre></div><p>を実行することでシェルが起動する</p>
<p>※ここで<code>exit</code>するとコンテナも終了する</p>
</li>
<li>
<p>補足</p>
<ul>
<li>ここではあくまで<code>/bin/bash</code>というコマンドを実行しているだけのため、<code>/bin/passwd</code>(パスワードの変更画面を表示)のような他のコマンドを実行することもできる。</li>
<li>他のシェルを使用したい場合には <code>/bin/bash</code> でなく <code>/bin/sh/</code> のように実行することもできる</li>
<li>現在使用しているシェルは<code>echo $SHELL</code>, 使用可能なシェルは<code>cat /etc/shells</code>で確認することができる。</li>
</ul>
</li>
</ul>

            <footer class="footline">
            </footer>
          </article>

          <article class="default">
<h1 id="appendix">Appendix</h1>

<h2 id="補足">補足</h2>
<h3 id="1回限り動かすコンテナの使い方">1回限り動かすコンテナの使い方</h3>
<p>（例）go言語でコンパイルするためのコンテナを作成する場合</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker run --rm -v <span style="color:#e6db74">&#34;</span>$PWD<span style="color:#e6db74">&#34;</span>:/usr/src/myapp -w /usr/src/myapp golang:1.13 go built -v
</span></span></code></pre></div><p>ここでは<code>go built -v</code> を実行してコンテナを終了・削除している。</p>

            <footer class="footline">
            </footer>
          </article>

          </section>        </div>
      </main>
    </div>
    <script src="/watanuki/js/clipboard.min.js?1669466243" defer></script>
    <script src="/watanuki/js/perfect-scrollbar.min.js?1669466243" defer></script>
    <script src="/watanuki/js/featherlight.min.js?1669466243" defer></script>
    <script src="/watanuki/js/theme.js?1669466243" defer></script>
  </body>
</html>
