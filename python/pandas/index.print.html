<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.104.3">
    <meta name="generator" content="Relearn 5.6.5+tip">
    <meta name="description" content="">
    <title>Pandas :: Chiyo&#39;s blog</title>
    <link href="https://moematsuda-ai.github.io/watanuki/python/pandas/index.html" rel="canonical" type="text/html" title="Pandas :: Chiyo&#39;s blog">
    <link href="/watanuki/python/pandas/index.xml" rel="alternate" type="application/rss+xml" title="Pandas :: Chiyo&#39;s blog">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/watanuki/css/fontawesome-all.min.css?1669379323" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/watanuki/css/fontawesome-all.min.css?1669379323" rel="stylesheet"></noscript>
    <link href="/watanuki/css/featherlight.min.css?1669379323" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/watanuki/css/featherlight.min.css?1669379323" rel="stylesheet"></noscript>
    <link href="/watanuki/css/auto-complete.css?1669379323" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/watanuki/css/auto-complete.css?1669379323" rel="stylesheet"></noscript>
    <link href="/watanuki/css/perfect-scrollbar.min.css?1669379323" rel="stylesheet">
    <link href="/watanuki/css/nucleus.css?1669379323" rel="stylesheet">
    <link href="/watanuki/css/fonts.css?1669379323" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/watanuki/css/fonts.css?1669379323" rel="stylesheet"></noscript>
    <link href="/watanuki/css/theme.css?1669379323" rel="stylesheet">
    <link href="/watanuki/css/theme-relearn-dark.css?1669379323" rel="stylesheet" id="variant-style">
    <link href="/watanuki/css/ie.css?1669379323" rel="stylesheet">
    <link href="/watanuki/css/variant.css?1669379323" rel="stylesheet">
    <link href="/watanuki/css/print.css?1669379323" rel="stylesheet" media="print">
    <link href="/watanuki/css/format-print.css?1669379323" rel="stylesheet">
    <script src="/watanuki/js/url.js?1669379323"></script>
    <script src="/watanuki/js/variant.js?1669379323"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="/watanuki/index.search.js";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/moematsuda-ai.github.io\/watanuki/';
      window.variants && variants.init( [ 'relearn-dark', 'relearn-light', 'green', 'black', 'blue', 'learn' ] );
    </script>
    <script src="/watanuki/js/jquery.min.js?1669379323" defer></script>
  </head>
  <body class="mobile-support print" data-url="/watanuki/python/pandas/index.html">
    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable" dir="ltr">
        <div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/watanuki/index.html"><span itemprop="name">Moai&#39;s blog</span></a><meta itemprop="position" content="1"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/watanuki/python/index.html"><span itemprop="name">Python</span></a><meta itemprop="position" content="2"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Pandas</span><meta itemprop="position" content="3"></li>
            </ol>
          </div>
        </div>
      </nav>
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <div id="head-tags">
          </div>
          <article class="default">
<h1 id="pandas">Pandas</h1>

<h2 id="pandasの概要">Pandasの概要</h2>
<p><code>pandas</code>はデータ解析を容易にするPythonのサードパーティライブラリです。
データ構造に対して様々な処理を施す機能を提供しており、他のライブラリをバックエンドとして利用して連携して動作できることやデータに対する豊富な処理機能を備えていることから、高度なデータ解析に欠かせないツールとなっている。NumpyのようにC言語による実装であるため配列演算の高速化が図られている点も大規模データの扱いを容易にする魅力の一つとなっている。</p>
<!-- raw HTML omitted -->
<h4 id="pydataとは">PyDataとは？</h4>
<p><strong>PyData</strong>とはPythonによるデータ管理/分析ツールのユーザと開発者のコミュニティです。
PyDataで話題とされるPythonツール群を総称して<strong>PyData Stack</strong>などと呼ぶ。</p>
<!-- raw HTML omitted -->
<h4 id="pandasで何ができる">Pandasで何ができる？</h4>
<p>Pndasはさまざまな形式で保存されたデータにアクセスし、効率的にそのデータを分析あるいは処理し、
その結果を可視化したり保存したりできるツールである。</p>
<ul>
<li>データを入出力する機能(CSV, Excel, RDB/<em>Relational DataBase</em>, HDF5など)</li>
<li>データを効率的かつ高速に処理できる形式でデータを格納</li>
<li>データのNaN（<em>Not a Number</em>、欠損値）処理</li>
<li>データの一部取り出しや結合</li>
<li>データの柔軟な変更やピボット(pivot)を処理</li>
<li>データに対する統計処理や回帰処理等</li>
<li>データの集約とグループ演算</li>
</ul>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h2 id="pandasのデータ型">Pandasのデータ型</h2>
<p>pandasにはプログラムで作成したデータや外部から読み込んだデータを保持しておくデータ構造として<strong>シリーズ、データフレーム、パネル</strong>の3つの形式があり、それぞれ1次元、2次元、3次元の配列に対応している。
また、それぞれのデータの位置または属性を表現するために<strong>行ラベル</strong>、<strong>列ラベル</strong>、<strong>アイテム名</strong>といったラベル名を設定する。</p>
<!-- raw HTML omitted -->
<h4 id="1-series">1. Series</h4>
<p>1次元データ保存用のデータ構造。格納するデータに制限はなく、すべての要素が同じデータ型である必要もない。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dat <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Serie([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">12</span>])
</span></span><span style="display:flex;"><span>dat2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series(np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, np<span style="color:#f92672">.</span>nan, <span style="color:#ae81ff">12</span>]))
</span></span><span style="display:flex;"><span>dat3 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#e6db74">&#39;aa&#39;</span>, <span style="color:#e6db74">&#39;bb&#39;</span>, <span style="color:#e6db74">&#39;c&#39;</span>, <span style="color:#e6db74">&#39;d&#39;</span>])
</span></span><span style="display:flex;"><span>dat4 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;aa&#39;</span>, <span style="color:#ae81ff">2.34</span>, <span style="color:#e6db74">&#39;d&#39;</span>])
</span></span></code></pre></div><p>行ラベルを指定しなかった場合には自動的に0から始まる整数が割り振られる。行ラベルの設定には生成時に引数としてindexを指定するか、辞書型変数（またはリテラル）をシリーズに渡すことで表ラベルを指定する方法がある。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dat5 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">12</span>], index<span style="color:#f92672">=</span>[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">33</span>])
</span></span><span style="display:flex;"><span>dat6 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">12</span>], index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;a&#39;</span>, <span style="color:#e6db74">&#39;b&#39;</span>, <span style="color:#e6db74">&#39;c&#39;</span>, <span style="color:#e6db74">&#39;a&#39;</span>])
</span></span><span style="display:flex;"><span>dat7 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series({<span style="color:#e6db74">&#39;a&#39;</span>:<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;b&#39;</span>:<span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;c&#39;</span>:<span style="color:#ae81ff">6</span>, <span style="color:#e6db74">&#39;d&#39;</span>:<span style="color:#ae81ff">12</span>})
</span></span></code></pre></div><p>行ラベルはindexという属性で割り当てられているため、<code>index</code>という変数で行ラベルを参照したり変更したりすることも可能である。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dat8<span style="color:#f92672">.</span>index <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;un&#39;</span>, <span style="color:#e6db74">&#39;due&#39;</span>, <span style="color:#e6db74">&#39;trois&#39;</span>, <span style="color:#e6db74">&#39;quatre&#39;</span>]
</span></span><span style="display:flex;"><span>print(dat8<span style="color:#f92672">.</span>index)
</span></span></code></pre></div><p>また、シリーズ形式では辞書型と違いデータに順番があり、0からカウントアップする順序インデックスが割り当てられている。（c言語の配列の添字みたいなもの）
そのため<strong>iloc</strong>プロパティで順序インデックスを使用することでデータを取り出すこともできる。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dat6<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">3</span>]
</span></span></code></pre></div><!-- raw HTML omitted -->
<h4 id="2-dataframe">2. DataFrame</h4>
<p>DataFrameは2次元のラベル付きデータ構造で、Pandasの中で最も使われることが多いデータタイプである。
Numpyからは2次元のndarrayをそのまま入力することができる。</p>
<p>データフレームでは行ラベル(<em>index</em>)と列ラベル(culmn)を同時に指定することができ、行ラベルは<code>index</code>、列ラベルは<code>culmn</code>でそれぞれ参照/変更することができる。</p>
<p>以下はDataFlameを格納する場合の一例である。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fruit_dat <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;c_都道府県&#39;</span>:[<span style="color:#e6db74">&#39;山梨&#39;</span>, <span style="color:#e6db74">&#39;福島&#39;</span>, <span style="color:#e6db74">&#39;長野&#39;</span>, <span style="color:#e6db74">&#39;栃木&#39;</span>, <span style="color:#e6db74">&#39;福岡&#39;</span>, <span style="color:#e6db74">&#39;熊本&#39;</span>, <span style="color:#e6db74">&#39;青森&#39;</span>, <span style="color:#e6db74">&#39;長野&#39;</span>, <span style="color:#e6db74">&#39;岩手&#39;</span>], <span style="color:#e6db74">&#39;a_果物&#39;</span>:[<span style="color:#e6db74">&#39;モモ&#39;</span>, <span style="color:#e6db74">&#39;モモ&#39;</span>, <span style="color:#e6db74">&#39;モモ&#39;</span>, <span style="color:#e6db74">&#39;りんご&#39;</span>, <span style="color:#e6db74">&#39;りんご&#39;</span>, <span style="color:#e6db74">&#39;りんご&#39;</span>, <span style="color:#e6db74">&#39;いちご&#39;</span>, <span style="color:#e6db74">&#39;いちご&#39;</span>, <span style="color:#e6db74">&#39;いちご&#39;</span>]}
</span></span><span style="display:flex;"><span>d <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(fruit_dat)<span style="color:#75715e">#辞書型からデータフレームに変換</span>
</span></span><span style="display:flex;"><span>d<span style="color:#f92672">.</span>columns
</span></span><span style="display:flex;"><span>print(Index(<span style="color:#e6db74">&#39;a_果物&#39;</span>, <span style="color:#e6db74">&#39;b_収穫量順位&#39;</span>, <span style="color:#e6db74">&#39;c_都道府県&#39;</span>], dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;object&#39;</span>))
</span></span></code></pre></div><p>ただしデータの列の順序は、列ラベルによって自動的にソートされて順序が変わるため注意が必要である。
上記の例でもデータを与えたときとデータフレームに格納後の順序は違っている。そこでデータフレームに格納する際に順序を変えないようにするには次のようにcolumns引数によって列の順序を指定することができる。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>d2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(fruit_dat, columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;a_果物&#39;</span>, <span style="color:#e6db74">&#39;c_都道府県&#39;</span>, <span style="color:#e6db74">&#39;d_収穫量順位&#39;</span>])
</span></span></code></pre></div><p>またシリーズを要素に持つ辞書型やリストからデータフレームを生成することも可能であり、データフレーム生成時に指定できるデータの方を次の表に示す。</p>
<table>
<thead>
<tr>
<th>データ型</th>
<th>概要説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>辞書型</td>
<td>辞書型の値としてリスト/タプル/シーケンスデータ/シリーズ/辞書型を値に持つもの</td>
</tr>
<tr>
<td>リスト</td>
<td>辞書型、シリーズ、リストまたはタプルのリスト</td>
</tr>
<tr>
<td>別のデータフレーム</td>
<td>データフレームの浅いコピーが生成される</td>
</tr>
<tr>
<td>Numpyの2次元ndarrayもしくはMaskedArray</td>
<td>データフレームの場合は2次元なので、2次元配列を受け付ける</td>
</tr>
</tbody>
</table>
<h6 id="階層化インデックスについて"><strong>階層化インデックス</strong>について</h6>
<p>3次元以上のデータを2次元データ形式のデータフレームで扱うためには行ラベルや列ラベルを複数階層のデータにする必要がある。
そのために必要なのが<strong>階層型インデックス</strong>である。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>), index <span style="color:#f92672">=</span> [[<span style="color:#e6db74">&#39;x&#39;</span>, <span style="color:#e6db74">&#39;x&#39;</span>, <span style="color:#e6db74">&#39;y&#39;</span>, <span style="color:#e6db74">&#39;y&#39;</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>]], columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Time_a&#39;</span>, <span style="color:#e6db74">&#39;Time_b&#39;</span>, <span style="color:#e6db74">&#39;Vel_a&#39;</span>, <span style="color:#e6db74">&#39;Vel_b&#39;</span>])
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>xs(<span style="color:#ae81ff">0</span>, level<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>); a<span style="color:#75715e">#データフレームのdxメソッドを使って、特定のラベル値のデータを抜き出す</span>
</span></span></code></pre></div><p>この例ではランダムに生成した4×4の行列データに対して2次元リストによる行ラベル(index)指定により、
xとyで区別される階層と0と1で区別される階層の2階層の行ラベルがつけられている。また2行目では表ラベルが(axis=0)の2層目(level=1)が0のデータを抽出している。</p>
<p>あとから階層型インデックスに変換する場合には次のように列ラベルを<code>_</code>で分割して多階層化する。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>MultiIndex<span style="color:#f92672">.</span>from_tuples([tuple(c<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;_&#39;</span>)) <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>columns])
</span></span></code></pre></div><!-- raw HTML omitted -->
<h4 id="3-panel">3. Panel</h4>
<p>パネルは3次元データの格納用に用意されたデータ構造である。
データフレームよりも次元が1つ大きくなるため<code>items</code>という属性が1つ増えており、次のように生成することができる。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">## キーの準備（キー：アイテム名、値：データフレーム）</span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;Iyrm1&#39;</span>: pd<span style="color:#f92672">.</span>DataFrame(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>)), <span style="color:#e6db74">&#39;Item2&#39;</span> : pd<span style="color:#f92672">.</span>DataFrame(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>))}
</span></span><span style="display:flex;"><span>pp1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Panel(data); pp1
</span></span></code></pre></div><p>ここではアイテム名として<code>Item1</code>, <code>Item2</code>が指定されており、<code>pp1.Item1</code>などのように記述することでそのアイテム名に対応するデータフレームにアクセスすることができる。</p>
<p>ただしPanelではindexは<code>major_axis</code>, columnは<code>minor_axis</code>という属性で割り当てられているため
行ラベルと列ラベルを指定してパネルを生成する場合には注意が必要である。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pp2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Pane(np<span style="color:#f92672">.</span>random<span style="color:#f92672">/</span>randn(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">3</span>), items<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Item1&#39;</span>, <span style="color:#e6db74">&#39;Item2&#39;</span>], major_axis<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>data_range(<span style="color:#e6db74">&#39;2/1/2016&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>), minor_axis<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;one&#39;</span>, <span style="color:#e6db74">&#39;two&#39;</span>, <span style="color:#e6db74">&#39;three&#39;</span>])
</span></span><span style="display:flex;"><span>print(pp2<span style="color:#f92672">.</span>major_axis)
</span></span><span style="display:flex;"><span>print(pp2<span style="color:#f92672">.</span>Item1<span style="color:#f92672">.</span>index)
</span></span></code></pre></div><p>ただし上記のプログラムの下2行は等価であり、同じ値を出力する。</p>
<h2 id="apispplicatopm-programming-interfaveとは">API(Spplicatopm Programming Interfave)とは？</h2>
<p><strong>API</strong>とはデータ処理/解析向けに実装されている様々な機能にアクセスする窓口となっている関数や
メソッドのことである。</p>
<p>Pandasの機能はPandas固有のデータ型ので意義が中心にあり、それにアクセスするための機能として、
pandasの関数とデータ型のメソッドの2種類のAPIがある。</p>
<p>外部ライブラリでは、Numexprやbottleneck(ndarray用の高速関数実装), Cythonが高速化のために使用され、
MatplotlibやXlsxWriter(Excelへの書き込み機能を提供するライブラリ)などは拡張機能として利用できる。</p>
<p>また、Pandasの機能にはixやlocなどの<strong>プロパティ</strong>も若干含まれている。これらは属性に直接アクセスしないで何らかの処理を経由して属性にアクセスする仕組みであり、インスタンスの属性を取り出したり設定したりするのに用いられる。</p>
<!-- raw HTML omitted -->
<h3 id="プロパティを使用したデータフレームのインデックス参照">プロパティを使用したデータフレームのインデックス参照</h3>
<p>下記のようなインデックス参照では、値を<strong>参照</strong>することも、その参照ポイントに値を<strong>設定</strong>することも可能。</p>
<table>
<thead>
<tr>
<th>プロパティ</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td>at</td>
<td>行ラベルと列ラベルによりスカラー値（1つのデータ）への参照を得る。<code>loc</code>より高速</td>
</tr>
<tr>
<td>iat</td>
<td>行番号と列番号によりスカラー値（1つのデータ）への参照を得る。<code>loc</code>より高速</td>
</tr>
<tr>
<td>loc</td>
<td>行ラベルと列ラベルによりベクトル（複数データ）またはスカラー値（1つのデータ）への参照を得る。</td>
</tr>
<tr>
<td>iloc</td>
<td>行番号と列番号によりベクトル（複数データ）またはスカラー値への参照を得る</td>
</tr>
<tr>
<td>ix</td>
<td>通常はlocのように機能するが、ラベルが指定されていない場合はilocのように機能する。</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>参照方法</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>df.at[&lsquo;y&rsquo;, &lsquo;b&rsquo;]</td>
<td>y行かつb列の値</td>
</tr>
<tr>
<td>df.loc[&lsquo;y&rsquo;, &lsquo;b&rsquo;]</td>
<td>y行かつb列の値</td>
</tr>
<tr>
<td>df.loc[&lsquo;x&rsquo;:&lsquo;y&rsquo;, &lsquo;b&rsquo;]</td>
<td>「「x行からy行(y行含む)」かつ「b列」の値</td>
</tr>
<tr>
<td>df.loc[:&lsquo;y&rsquo;, :]</td>
<td>「最初の行からy行（y行含む）」かつ「b列」の値」</td>
</tr>
<tr>
<td>df.iat[0, 1]</td>
<td>0行1列の値</td>
</tr>
<tr>
<td>df.iloc[1, 1]</td>
<td>1行1列の値</td>
</tr>
<tr>
<td>df.iloc[0:2, -2:]</td>
<td>0〜１行かつ最後の２列の値</td>
</tr>
<tr>
<td>df.iloc[:1, :]</td>
<td>0行全列</td>
</tr>
<tr>
<td>df.ix[&lsquo;x&rsquo;, [&lsquo;a&rsquo;, &rsquo;d&rsquo;]]</td>
<td>「x行」かつ「a列またはd列」</td>
</tr>
<tr>
<td>df.ix[&lsquo;x&rsquo;]</td>
<td>x行を取り出し（結果はシリーズ）</td>
</tr>
<tr>
<td>df.ix[&lsquo;x&rsquo;][&lsquo;a&rsquo;]</td>
<td>x行かつa列</td>
</tr>
<tr>
<td>df.ix[:, &lsquo;a&rsquo;]</td>
<td>a列を取り出し（結果はシリーズ）</td>
</tr>
<tr>
<td>df.ix[df.d &gt; 6, :2]</td>
<td>「d列が６より大の行」かつ「最初の２列」</td>
</tr>
</tbody>
</table>
<p><strong>同じデータを参照する方法は複数あるが、使っているOSやpandasの実装の改善等によって処理速度に差がある場合がある。そのような場合は<code>%timeit</code>マジックコマンドを使えば、簡単に調べることができる。</strong></p>
<!-- raw HTML omitted -->
<h3 id="データフレームに対する直接インデックス参照">データフレームに対する直接インデックス参照</h3>
<table>
<thead>
<tr>
<th>参照方法</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>df[&lsquo;a&rsquo;]</td>
<td>列ラベルaの列</td>
</tr>
<tr>
<td>df[[&lsquo;a&rsquo;, &lsquo;c&rsquo;]</td>
<td>列ラベルaよc</td>
</tr>
<tr>
<td>df[:2]</td>
<td>０行目と１行目</td>
</tr>
<tr>
<td>df[df[&rsquo;d&rsquo;] &gt; 6]</td>
<td>列ラベルdの列の値が６より大の行の行全体</td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<h3 id="基本的な演算規則">基本的な演算規則</h3>
<p>シリーズやデータフレームなどに対する四則演算は、加減乗除の記号によって実現する方法とメソッドを使う方法の２種類がある。</p>
<ol>
<li>
<p>加減乗除
要素ごとに演算を行う</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser_a1 <span style="color:#f92672">=</span> ser1 <span style="color:#f92672">+</span> ser2
</span></span></code></pre></div></li>
<li>
<p>メソッド
インスタンスデータが変更されるものではないため、何らかの変数に格納する必要がある。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ser_a2 <span style="color:#f92672">=</span> ser1<span style="color:#f92672">.</span>add(ser2)
</span></span></code></pre></div><p><strong>NaN</strong>を含む式の計算はすべて<strong>NaN</strong>となるが、メソッドを使用した計算ではNaNを特定の
値に置き換えて計算できるという利点がある。</p>
</li>
</ol>
<h2 id="pandasの使い方">Pandasの使い方</h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h3 id="dataflame">DataFlame</h3>
<h5 id="dataflameの定義">DataFlameの定義</h5>
<ol>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;Yes&#39;</span>: [<span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">21</span>], <span style="color:#e6db74">&#39;No&#39;</span>: [<span style="color:#ae81ff">131</span>, <span style="color:#ae81ff">2</span>]})
</span></span></code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Yes</th>
<th>No</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>50</td>
<td>131</td>
</tr>
<tr>
<td>1</td>
<td>21</td>
<td>2</td>
</tr>
</tbody>
</table>
</li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;Bob&#39;</span>: [<span style="color:#e6db74">&#39;I liked it.&#39;</span>, <span style="color:#e6db74">&#39;It was awful.&#39;</span>], <span style="color:#e6db74">&#39;Sue&#39;</span>: [<span style="color:#e6db74">&#39;Pretty good.&#39;</span>, <span style="color:#e6db74">&#39;Bland.&#39;</span>]})
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fruits <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([[<span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">21</span>]], columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Apples&#39;</span>, <span style="color:#e6db74">&#39;Bananas&#39;</span>])
</span></span></code></pre></div></li>
</ol>
<!-- raw HTML omitted -->
<h5 id="index化">index化</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fruit_sales <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([[<span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">21</span>], [<span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">34</span>]], columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Apples&#39;</span>, <span style="color:#e6db74">&#39;Bananas&#39;</span>],index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;2017 Sales&#39;</span>, <span style="color:#e6db74">&#39;2018 Sales&#39;</span>])
</span></span></code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h3 id="series">Series</h3>
<h5 id="seriesの定義">Seriesの定義</h5>
<ol>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>])
</span></span></code></pre></div></li>
</ol>
<h5 id="index化-1">index化</h5>
<ol>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">40</span>], index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;2015 Sales&#39;</span>, <span style="color:#e6db74">&#39;2016 Sales&#39;</span>, <span style="color:#e6db74">&#39;2017 Sales&#39;</span>], name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Product A&#39;</span>)
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> quantities <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;4 cups&#39;</span>, <span style="color:#e6db74">&#39;1 cup&#39;</span>, <span style="color:#e6db74">&#39;2 large&#39;</span>, <span style="color:#e6db74">&#39;1 can&#39;</span>]
</span></span><span style="display:flex;"><span> items <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Flour&#39;</span>, <span style="color:#e6db74">&#39;Milk&#39;</span>, <span style="color:#e6db74">&#39;Eggs&#39;</span>, <span style="color:#e6db74">&#39;Spam&#39;</span>]
</span></span><span style="display:flex;"><span> recipe <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series(quantities, index<span style="color:#f92672">=</span>items, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Dinner&#39;</span>)
</span></span></code></pre></div></li>
</ol>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h3 id="csvファイルへの入出力">csvファイルへの入出力</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>animals<span style="color:#f92672">.</span>to_csv(<span style="color:#e6db74">&#34;cows_and_goats.csv&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>reviews <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;../input/wine-reviews/winemag-data_first150k.csv&#39;</span>, index_col<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span></code></pre></div><p>※<code>index_col=0</code>で0列目を<code>index</code>に指定している。</p>
<!-- raw HTML omitted -->
<h5 id="unicodedecodeerror-utf-8-codec-cant-decode-byte-0x92-in-position-0-invalid-start-byte-というエラーが出る"><strong>UnicodeDecodeError: &lsquo;utf-8&rsquo; codec can&rsquo;t decode byte 0x92 in position 0: invalid start byte</strong> というエラーが出る</h5>
<p>【解決法】</p>
<ol>
<li>
<p>**shift-jisの場合</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;filename.csv&#34;</span>, encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;shift-jis&#34;</span>)
</span></span></code></pre></div></li>
<li>
<p>windowsで作成されたファイルは以下の場合も</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;filename.csv&#34;</span>, encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;cp932&#34;</span>)
</span></span></code></pre></div></li>
</ol>
<p>【参考】<a href="https://paper.hatenadiary.jp/entry/2016/10/05/140013#%E8%A7%A3%E6%B1%BA%E6%B3%95%EF%BC%91%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A7%E6%8C%87%E5%AE%9A">エラー解決：pandas.read_csvで日本語を含んだcsvを読み込めない</a></p>
<h2 id="pandasでのindexing">Pandasでのindexing</h2>
<h3 id="indexによるデータへのアクセス">indexによるデータへのアクセス</h3>
<ol>
<li>
<p><code>attribute</code> や <code>operator []</code> によるアクセス</p>
<p><code>reviews</code>データが次のような値を持つとすると、</p>
<pre><code> | --- |country|description|designation|
 | --- | --- | --- | --- |
 |0| Italy| 	Aromas include tropical fruit, broom, brimston... 	|Vulkà Bianco 	|
 |1| Portugal| 	This is ripe and fruity, a wine that is smooth...| 	Avidagos 	|
 |...| 	...| 	... |...|
 |129969| 	France| 	A dry style of Pinot Gris, this is crisp with ... 	|NaN 	|
 |129970| 	France| 	Big, rich and off-dry, this is powered by inte... 	|Lieu-dit Harth Cuvée Caroline 	|
</code></pre>
<p><code>reviews</code>の<code>country</code>プロパティへは以下のいずれかの方法でアクセスする</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>reviews<span style="color:#f92672">.</span>country
</span></span><span style="display:flex;"><span>reviews[<span style="color:#e6db74">&#39;country&#39;</span>]
</span></span></code></pre></div><p>※ただし<code>[ ]</code>であれば<code>+, -, 空白</code> などの予約文字も扱え、以下のようにもう一度<code>[]</code>を使うだけでドリルダウンできる（下記の出力は<code>Italy</code>）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>reviews[<span style="color:#e6db74">&#39;country&#39;</span>][<span style="color:#ae81ff">0</span>]
</span></span></code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
</li>
<li>
<p><code>loc</code>や<code>iloc</code>によるアクセス</p>
</li>
</ol>
<h3 id="例文">例文</h3>
<ol>
<li>
<pre tabindex="0"><code>desc = reviews.description

or

desc = reviews[&#34;description&#34;]

desc is a pandas Series object, with an index matching the reviews DataFrame. In general, when we select a single column from a DataFrame, we&#39;ll get a Series.
</code></pre></li>
<li>
<pre tabindex="0"><code>Solution:

first_description = reviews.description.iloc[0]

Note that while this is the preferred way to obtain the entry in the DataFrame, many other options will return a valid result, such as reviews.description.loc[0], reviews.description[0], and more!
</code></pre></li>
<li>
<pre tabindex="0"><code>first_row = reviews.iloc[0]
</code></pre></li>
<li>
<pre tabindex="0"><code>first_descriptions = reviews.description.iloc[:10]

Note that many other options will return a valid result, such as desc.head(10) and reviews.loc[:9, &#34;description&#34;]. 
</code></pre></li>
<li>
<pre tabindex="0"><code>indices = [1, 2, 3, 5, 8]
sample_reviews = reviews.loc[indices]
</code></pre></li>
<li>
<pre tabindex="0"><code>cols = [&#39;country&#39;, &#39;province&#39;, &#39;region_1&#39;, &#39;region_2&#39;]
indices = [0, 1, 10, 100]
df = reviews.loc[indices, cols]
</code></pre><ol>
<li></li>
</ol>
<pre tabindex="0"><code>cols = [&#39;country&#39;, &#39;variety&#39;]
df = reviews.loc[:99, cols]

or

cols_idx = [0, 11]
df = reviews.iloc[:100, cols_idx]
</code></pre></li>
<li>
<pre tabindex="0"><code>italian_wines = reviews[reviews.country == &#39;Italy&#39;]
</code></pre></li>
<li>
<pre tabindex="0"><code>top_oceania_wines = reviews.loc[
    (reviews.country.isin([&#39;Australia&#39;, &#39;New Zealand&#39;]))
    &amp; (reviews.points &gt;= 95)
]
</code></pre></li>
</ol>
<h2 id="pandas-summary-functions-and-maps">Pandas 「Summary Functions and Maps」</h2>
<ol>
<li>
<p>Numpyで要約統計量の取得</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>median_points <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>points<span style="color:#f92672">.</span>median()
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>countries <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>country<span style="color:#f92672">.</span>unique()
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>reviews_per_country <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>country<span style="color:#f92672">.</span>value_counts()
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>centered_price <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>price <span style="color:#f92672">-</span> reviews<span style="color:#f92672">.</span>price<span style="color:#f92672">.</span>mean()
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>bargain_idx <span style="color:#f92672">=</span> (reviews<span style="color:#f92672">.</span>points <span style="color:#f92672">/</span> reviews<span style="color:#f92672">.</span>price)<span style="color:#f92672">.</span>idxmax()
</span></span><span style="display:flex;"><span>bargain_wine <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>loc[bargain_idx, <span style="color:#e6db74">&#39;title&#39;</span>]
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>n_trop <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>description<span style="color:#f92672">.</span>map(<span style="color:#66d9ef">lambda</span> desc: <span style="color:#e6db74">&#34;tropical&#34;</span> <span style="color:#f92672">in</span> desc)<span style="color:#f92672">.</span>sum()
</span></span><span style="display:flex;"><span>n_fruity <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>description<span style="color:#f92672">.</span>map(<span style="color:#66d9ef">lambda</span> desc: <span style="color:#e6db74">&#34;fruity&#34;</span> <span style="color:#f92672">in</span> desc)<span style="color:#f92672">.</span>sum()
</span></span><span style="display:flex;"><span>descriptor_counts <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([n_trop, n_fruity], index<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;tropical&#39;</span>, <span style="color:#e6db74">&#39;fruity&#39;</span>])
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">stars</span>(row):
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> row<span style="color:#f92672">.</span>country <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;Canada&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">elif</span> row<span style="color:#f92672">.</span>points <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">95</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">elif</span> row<span style="color:#f92672">.</span>points <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">85</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>star_ratings <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>apply(stars, axis<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;columns&#39;</span>)
</span></span></code></pre></div></li>
</ol>
<h2 id="groutping-and-sorting">Groutping and Sorting</h2>
<h3 id="groupwise-amalysis">Groupwise amalysis</h3>
<p>次のような<code>groupby()</code>関数を用いることで指定した列の同じ値を持つデータをグループ化し、
同じ操作を行うことができる。</p>
<ol>
<li>point列の同じ値を持つものをグループ化し、その値が何回出現したかをカウントする。出力はpointの値と出現回数の
以下どちらの方法でもOK！</li>
</ol>
<ul>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>reviews<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;points&#39;</span>)<span style="color:#f92672">.</span>points<span style="color:#f92672">.</span>count()
</span></span></code></pre></div><p><code>point</code>の値の小さい順で出力
【出力結果】</p>
<pre tabindex="0"><code>points
80     397
81     692
    ... 
99      33
100     19
Name: points, Length: 21, dtype: int64
</code></pre></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>  reviews<span style="color:#f92672">.</span>value_counts(<span style="color:#e6db74">&#39;points&#39;</span>)
</span></span></code></pre></div><p>出現回数の大きい順で出力</p>
</li>
</ul>
<ol>
<li>
<p>point列の同じ値を持つものをグループ化し、その<code>price</code>列の最小値を配列Seriesに格納</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>reviews<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;points&#39;</span>)<span style="color:#f92672">.</span>price<span style="color:#f92672">.</span>min()
</span></span></code></pre></div><p>【出力結果】</p>
<pre tabindex="0"><code>points
80      5.0
81      5.0
    ... 
99     44.0
100    80.0
Name: price, Length: 21, dtype: float64
</code></pre></li>
<li>
<p><code>title</code>列に同じ値を持つものをグループ化し、そのグループ内で最も行数が少ない要素の<code>title</code>列の値を出力</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>reviews<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;winery&#39;</span>)<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> df: df<span style="color:#f92672">.</span>title<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>])
</span></span></code></pre></div></li>
</ol>
<h3 id="その他">その他</h3>
<ol>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> reviews_written <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;taster_twitter_handle&#39;</span>)<span style="color:#f92672">.</span>size()
</span></span><span style="display:flex;"><span> reviews_written <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;taster_twitter_handle&#39;</span>)<span style="color:#f92672">.</span>taster_twitter_handle<span style="color:#f92672">.</span>count()
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> best_rating_per_price <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;price&#39;</span>)[<span style="color:#e6db74">&#39;points&#39;</span>]<span style="color:#f92672">.</span>max()<span style="color:#f92672">.</span>sort_index()
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> price_extremes <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;variety&#39;</span>)<span style="color:#f92672">.</span>price<span style="color:#f92672">.</span>agg([min, max])
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> sorted_varieties <span style="color:#f92672">=</span> price_extremes<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;min&#39;</span>, <span style="color:#e6db74">&#39;max&#39;</span>], ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> reviewer_mean_ratings <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;taster_name&#39;</span>)<span style="color:#f92672">.</span>points<span style="color:#f92672">.</span>mean()
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> country_variety_counts <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>value_counts([<span style="color:#e6db74">&#39;country&#39;</span>, <span style="color:#e6db74">&#39;variety&#39;</span>])
</span></span></code></pre></div><p>または</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>country_variety_counts <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;country&#39;</span>, <span style="color:#e6db74">&#39;variety&#39;</span>])<span style="color:#f92672">.</span>variety<span style="color:#f92672">.</span>count()<span style="color:#f92672">.</span>sort_values(ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span></code></pre></div><p>※<code>count()</code>モジュールは<code>size()</code>モジュールでもOK!</p>
</li>
</ol>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h4 id="参考文献">参考文献</h4>
<ul>
<li><a href="https://qiita.com/propella/items/a9a32b878c77222630ae">https://qiita.com/propella/items/a9a32b878c77222630ae</a></li>
<li><a href="https://note.nkmk.me/python-pandas-map-applymap-apply/">https://note.nkmk.me/python-pandas-map-applymap-apply/</a></li>
<li><a href="https://ejje.weblio.jp/content/fit">https://ejje.weblio.jp/content/fit</a></li>
<li><a href="https://note.nkmk.me/python-pandas-at-iat-loc-iloc/">https://note.nkmk.me/python-pandas-at-iat-loc-iloc/</a></li>
</ul>
<h2 id="data-types-and-missing-values">Data Types and Missing Values</h2>
<ol>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> dtype <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>points<span style="color:#f92672">.</span>dtype
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> point_strings <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>points<span style="color:#f92672">.</span>astype(str)
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> missing_price_reviews <span style="color:#f92672">=</span> reviews[reviews<span style="color:#f92672">.</span>price<span style="color:#f92672">.</span>isnull()]
</span></span><span style="display:flex;"><span> n_missing_prices <span style="color:#f92672">=</span> len(missing_price_reviews)
</span></span></code></pre></div><p>または</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">## Cute alternative solution: if we sum a boolean series, True is treated as 1 and False as 0</span>
</span></span><span style="display:flex;"><span>n_missing_prices <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>price<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum()
</span></span></code></pre></div><p>または</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">## or equivalently:</span>
</span></span><span style="display:flex;"><span>n_missing_prices <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>isnull(reviews<span style="color:#f92672">.</span>price)<span style="color:#f92672">.</span>sum()
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> reviews_per_region <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>fillna(<span style="color:#e6db74">&#34;unknown&#34;</span>)<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;region_1&#39;</span>)<span style="color:#f92672">.</span>region_1<span style="color:#f92672">.</span>count()<span style="color:#f92672">.</span>sort_values(ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span></code></pre></div><p>または</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>reviews_per_region <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>region_1<span style="color:#f92672">.</span>fillna(<span style="color:#e6db74">&#39;Unknown&#39;</span>)<span style="color:#f92672">.</span>value_counts()<span style="color:#f92672">.</span>sort_values(ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span></code></pre></div></li>
</ol>
<h2 id="renaming-and-combining">Renaming and Combining</h2>
<ol>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> renamed <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;region_1&#39;</span>:<span style="color:#e6db74">&#39;region&#39;</span>, <span style="color:#e6db74">&#39;region_2&#39;</span>:<span style="color:#e6db74">&#39;locale&#39;</span>})
</span></span></code></pre></div><p>または</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>renamed <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>dict(region_1<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;region&#39;</span>, region_2<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;locale&#39;</span>))
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> reindexed <span style="color:#f92672">=</span> reviews<span style="color:#f92672">.</span>rename_axis(<span style="color:#e6db74">&#39;wines&#39;</span>, axis<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;rows&#39;</span>)
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> combined_products <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([gaming_products, movie_products])
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> powerlifting_combined <span style="color:#f92672">=</span> powerlifting_meets<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;MeetID&#39;</span>)<span style="color:#f92672">.</span>join(powerlifting_competitors<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;MeetID&#39;</span>))
</span></span></code></pre></div><p>または</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>powerlifting_combined <span style="color:#f92672">=</span> powerlifting_meets<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#34;MeetID&#34;</span>)<span style="color:#f92672">.</span>join(powerlifting_competitors<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#34;MeetID&#34;</span>))
</span></span></code></pre></div></li>
</ol>
<h2 id="pandasの便利なfunction">Pandasの便利なfunction</h2>
<h3 id="shape-attribute">&ldquo;shape&rdquo; attribute</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>wine_reviews<span style="color:#f92672">.</span>shape
</span></span></code></pre></div><p>【出力】</p>
<pre tabindex="0"><code>(129971, 14)
</code></pre><ul>
<li>DataFrameがどれくらいの大きさを持つかを出力する関数</li>
<li>14の異なる列に分割された130,000のレコードを持つ</li>
<li>約2,000万個のエントリを持つ</li>
</ul>
<h3 id="head-command">&ldquo;head()&rdquo; command</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>wine_reviews<span style="color:#f92672">.</span>head()
</span></span></code></pre></div><ul>
<li>先頭から5行を表示するコマンド</li>
</ul>
<h3 id="差分を計算">差分を計算</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_re <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>diff()
</span></span></code></pre></div><p>【出力結果】</p>
<pre tabindex="0"><code>     a    b     c
0  NaN  NaN   NaN
1  1.0  3.0   7.0
2  1.0  5.0  19.0
3  1.0  7.0  37.0
4  1.0  9.0  61.0
</code></pre><p>【引数】</p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td>periods</td>
<td>指定した行数分だけ前（もしくは後）の要素との差を求める<!-- raw HTML omitted --> ※負の値も指定可能（付の値では後ろの要素が<code>NaN</code>の値をとる）</td>
</tr>
<tr>
<td>axis</td>
<td><code>axis=1</code>と指定すると列ごとの差分を算出（デフォルトは<code>0</code>）</td>
</tr>
</tbody>
</table>
<p>【参考】</p>
<ul>
<li><a href="https://note.nkmk.me/python-pandas-diff-pct-change/">pandasで行・列の差分・変化率を取得するdiff, pct_change</a></li>
</ul>
<h3 id="index-の割当">index の割当</h3>
<ol>
<li>
<p>indexの初期化</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_i <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>reset_index()
</span></span></code></pre></div><p>※ノーマルではindexの値が新しい列として挿入される
※（）内に&rsquo;drop=False&rsquo;と記述するとデータ部はそのままでindexだけ変更できる</p>
</li>
<li>
<p>DataFrameの列をindexに指定</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_i <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;name&#39;</span>)
</span></span></code></pre></div><p>※ <code>name</code> という列を index として指定</p>
<p>【引数】</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>コマンド</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td>drop</td>
<td><code>drop = False</code></td>
<td>指定列がデータ列にも残る<!-- raw HTML omitted -->デフォルトではindexに指定されたデータ列は消える(<code>drop = True</code>)</td>
</tr>
</tbody>
</table>
</li>
</ol>
<p>【参考】</p>
<ul>
<li><a href="https://note.nkmk.me/python-pandas-reset-index/">pandas.DataFrame, Seriesのインデックスを振り直すreset_index</a></li>
<li><a href="https://note.nkmk.me/python-pandas-set-index/">pandas.DataFrameの列をインデックス（行名）に割り当てるset_index</a></li>
</ul>
<!-- raw HTML omitted -->
<h3 id="カラム名の変更">カラム名の変更</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>arra<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;A&#39;</span>, <span style="color:#e6db74">&#39;B&#39;</span>]
</span></span></code></pre></div><p>【参考】</p>
<ul>
<li><a href="https://note.nkmk.me/python-pandas-dataframe-rename/">pandas.DataFrameの行名・列名の変更</a></li>
</ul>
<h3 id="dataframeやseriesの文字列や空白を削除">DataFrameやSeriesの文字列や空白を削除</h3>
<table>
<thead>
<tr>
<th>概要</th>
<th>コマンド</th>
</tr>
</thead>
<tbody>
<tr>
<td>文字列の置換</td>
<td><code>.str.replace('置換前', '置換後')</code></td>
</tr>
<tr>
<td>空白の削除(左右)</td>
<td><code>.str.strip()</code></td>
</tr>
<tr>
<td>空白の削除（左）</td>
<td><code>.str.lstrip()</code></td>
</tr>
<tr>
<td>空白の削除(右)</td>
<td><code>.str.rstrip()</code></td>
</tr>
</tbody>
</table>
<h3 id="型変換と型判定">型変換と型判定</h3>
<table>
<thead>
<tr>
<th>概要</th>
<th>コマンド</th>
</tr>
</thead>
<tbody>
<tr>
<td>if文で型を判定(出力は<code>True</code> or <code>false</code></td>
<td><code>if type(a) == int:</code></td>
</tr>
<tr>
<td>str型とfloatまたはint型の変換</td>
<td><code>.astype(変更後の型名(int or float or str))</code> <!-- raw HTML omitted --> ※strからintへは直接変換できないため一度float型に変換する</td>
</tr>
<tr>
<td>各要素ごとに型の確認（配列として出力される）</td>
<td><code>.dtype()</code></td>
</tr>
</tbody>
</table>
<p>【参考】</p>
<ul>
<li><a href="https://techacademy.jp/magazine/34202">Pythonでtype関数を利用して型判定する方法を現役エンジニアが解説【初心者向け】</a></li>
</ul>
<!-- raw HTML omitted -->
<h3 id="dataframe-または-series-で特定の文字列を検索">DataFrame または Series で特定の文字列を検索</h3>
<table>
<thead>
<tr>
<th>概要</th>
<th>コマンド</th>
</tr>
</thead>
<tbody>
<tr>
<td>完全一致(==) <!-- raw HTML omitted --> 要素が文字列に完全一致するとTrueとなるpandas.Seriesを取得できる。</td>
<td><code>変数名[変数名['列名'] == '検索する文字列']</code></td>
</tr>
</tbody>
</table>
<p>【参考】</p>
<ul>
<li><a href="https://note.nkmk.me/python-pandas-str-contains-match/">pandasで特定の文字列を含む行を抽出（完全一致、部分一致）</a></li>
</ul>
<!-- raw HTML omitted -->
<h3 id="series-や-dataframe-の結合">Series や DataFrame の結合</h3>
<ul>
<li><strong>concat 関数</strong></li>
</ul>
<p>下記のように記述することで DataFrame <code>s1</code> と<code>s2</code> が結合できる(結合したDataFrameが返却値)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>arr <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([s1, s2])
</span></span></code></pre></div><p>【引数】</p>
<table>
<thead>
<tr>
<th>引数</th>
<th>引数の指定方法</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td>axis</td>
<td>axis=0</td>
<td>縦方向に（行で）連結</td>
</tr>
<tr>
<td>axis</td>
<td>axis=1</td>
<td>横方向（列で）連結</td>
</tr>
<tr>
<td>join</td>
<td>よくわかってない&hellip; →　後で調べて</td>
<td>内部結合・外部結合を指定</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>merge 関数</strong>
また調べて&hellip;</li>
</ul>
<p>【参考】</p>
<ul>
<li><a href="https://note.nkmk.me/python-pandas-concat/">pandas.DataFrame, Seriesを連結するconcat</a></li>
<li><a href="https://pppurple.hatenablog.com/entry/2016/06/27/022310#concat%E9%96%A2%E6%95%B0">pandasの使い方（merge、join、concat編）</a></li>
</ul>
<h3 id="pandasで要素行列荷関数を適用">pandasで要素・行・列荷関数を適用</h3>
<table>
<thead>
<tr>
<th>対象</th>
<th>関数</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td>Series</td>
<td><code>map</code></td>
<td>Series の各要素に関数を適用</td>
</tr>
<tr>
<td>Series, DataFrame</td>
<td><code>apply</code></td>
<td>Series の各要素に関数を適用（デフォルトは<code>axis=0</code>で各列に対する処理、<code>axis=0</code>で各行に対する処理も可能）</td>
</tr>
<tr>
<td>DataFrame</td>
<td><code>applymap</code></td>
<td>DataFrameの各要素に関数を適用</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fx <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> x: x <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">/</span> a
</span></span></code></pre></div><p>【参考】</p>
<ul>
<li><a href="https://note.nkmk.me/python-pandas-map-applymap-apply/">pandasで要素、行、列に関数を適用するmap, applymap, apply</a></li>
</ul>
<!-- raw HTML omitted -->
<h3 id="pandasdataframeの行や列を削除">pandas.DataFrameの行や列を削除</h3>
<ul>
<li><a href="https://note.nkmk.me/python-pandas-drop/">pandas.DataFrameの行・列を指定して削除するdrop</a></li>
</ul>
<p>【参考】</p>
<ul>
<li><a href="https://note.nkmk.me/python-pandas-str-replace-strip-etc/">pandasの文字列メソッドで置換や空白削除などの処理を行う</a></li>
</ul>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>【参考】</p>
<ul>
<li><a href="https://note.nkmk.me/python-pandas-str-replace-strip-etc/">pandasの文字列メソッドで置換や空白削除などの処理を行う</a></li>
<li><a href="https://note.nkmk.me/python-pandas-str-num-conversion/">pandasで文字列と数値を相互変換、書式変更</a></li>
<li><a href="https://note.nkmk.me/python-pandas-str-contains-match/">pandasで特定の文字列を含む行を抽出（完全一致、部分一致）</a></li>
<li><a href="https://techacademy.jp/magazine/34202">Pythonでtype関数を利用して型判定する方法を現役エンジニアが解説【初心者向け】</a></li>
<li><a href="https://pppurple.hatenablog.com/entry/2016/06/27/022310#concat%E9%96%A2%E6%95%B0">pandasの使い方（merge、join、concat編）</a></li>
<li><a href="https://note.nkmk.me/python-pandas-concat/">pandas.DataFrame, Seriesを連結するconcat</a></li>
<li><a href="https://note.nkmk.me/python-pandas-set-index/">pandas.DataFrameの列をインデックス（行名）に割り当てるset_index</a></li>
<li><a href="https://note.nkmk.me/python-pandas-reset-index/">pandas.DataFrame, Seriesのインデックスを振り直すreset_index</a></li>
<li><a href="https://note.nkmk.me/python-pandas-dataframe-rename/">pandas.DataFrameの行名・列名の変更</a></li>
<li><a href="https://note.nkmk.me/python-pandas-map-applymap-apply/">pandasで要素、行、列に関数を適用するmap, applymap, apply</a></li>
<li><a href="https://note.nkmk.me/python-pandas-diff-pct-change/">pandasで行・列の差分・変化率を取得するdiff, pct_change</a></li>
<li><a href="https://note.nkmk.me/python-pandas-assign-append/">pandas.DataFrameに列や行を追加（assign, appendなど）</a></li>
</ul>

            <footer class="footline">
            </footer>
          </article>
        </div>
      </main>
    </div>
    <script src="/watanuki/js/clipboard.min.js?1669379323" defer></script>
    <script src="/watanuki/js/perfect-scrollbar.min.js?1669379323" defer></script>
    <script src="/watanuki/js/featherlight.min.js?1669379323" defer></script>
    <script src="/watanuki/js/theme.js?1669379323" defer></script>
  </body>
</html>
